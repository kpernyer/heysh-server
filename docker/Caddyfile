# Hey.sh Local Development - Caddy Configuration
# Maps hostnames to local services for development

# =============================================================================
# CORE APPLICATION SERVICES
# =============================================================================

# Frontend Application
http://hey.local {
    reverse_proxy host.docker.internal:3000 {
        header_up Host {host}
        header_up X-Real-IP {remote}
        header_up X-Forwarded-For {remote}
        header_up X-Forwarded-Proto {scheme}
    }
    log {
        output stdout
        format console
    }
}

# Frontend Application (www subdomain)
http://www.hey.local {
    reverse_proxy host.docker.internal:3000 {
        header_up Host {host}
        header_up X-Real-IP {remote}
        header_up X-Forwarded-For {remote}
        header_up X-Forwarded-Proto {scheme}
    }
    log {
        output stdout
        format console
    }
}

# Backend API
http://api.hey.local {
    reverse_proxy host.docker.internal:8002 {
        header_up Host {host}
        header_up X-Real-IP {remote}
        header_up X-Forwarded-For {remote}
        header_up X-Forwarded-Proto {scheme}
    }
    header Access-Control-Allow-Origin "*"
    header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
    header Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
    header Access-Control-Allow-Credentials "true"
    log {
        output stdout
        format console
    }
}

# Temporal UI
http://temporal.hey.local {
    reverse_proxy 127.0.0.1:8090
    log {
        output stdout
        format console
    }
}

# =============================================================================
# DATABASE & STORAGE SERVICES
# =============================================================================

# PostgreSQL Database
http://db.hey.local {
    reverse_proxy 127.0.0.1:5432
    log {
        output stdout
        format console
    }
}

# Neo4j Browser
http://neo4j.hey.local {
    reverse_proxy 127.0.0.1:7474
    log {
        output stdout
        format console
    }
}

# Weaviate Vector Database
http://weaviate.hey.local {
    reverse_proxy weaviate:8080
    log {
        output stdout
        format console
    }
}

# Redis Cache
http://redis.hey.local {
    reverse_proxy 127.0.0.1:6379
    log {
        output stdout
        format console
    }
}

# Document Storage (abstracted - implementation varies by environment)
# Local: MinIO (S3-compatible)
# Production: Supabase Storage
http://storage.hey.local {
    reverse_proxy 127.0.0.1:9000
    log {
        output stdout
        format console
    }
}

# MinIO Admin Console (dev tool - local only)
http://minio-console.hey.local {
    reverse_proxy 127.0.0.1:9001
    log {
        output stdout
        format console
    }
}

# =============================================================================
# MONITORING SERVICES (Optional)
# =============================================================================

# Prometheus Metrics
http://monitoring.hey.local {
    reverse_proxy 127.0.0.1:9090
    log {
        output stdout
        format console
    }
}

# Grafana Dashboards
http://grafana.hey.local {
    reverse_proxy 127.0.0.1:3001
    log {
        output stdout
        format console
    }
}

# Alertmanager
http://alertmanager.hey.local {
    reverse_proxy 127.0.0.1:9093
    log {
        output stdout
        format console
    }
}

# Jaeger Tracing
http://jaeger.hey.local {
    reverse_proxy 127.0.0.1:16686
    log {
        output stdout
        format console
    }
}

# Loki Logs
http://loki.hey.local {
    reverse_proxy 127.0.0.1:3100
    log {
        output stdout
        format console
    }
}